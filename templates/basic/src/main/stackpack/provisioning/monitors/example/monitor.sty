  - _type: "Monitor"
    name: "HTTP - 5xx error ratio"
    tags:
      - services
    function: {{ get "urn:stackpack:common:monitor-function:topological-threshold"  }}
    arguments:
      comparator: GTE
      failureState: UNKNOWN
      queries:
        topologyQuery: (label = "stackpack:kubernetes" and type = "service")
        promqlQuery: 'any(present_over_time(podparty_http_requests_count{cluster_name="${tags.cluster-name}", direction="incoming", intra_pod!="true", local_pod_ns="${tags.namespace}", __multi__="${properties.local_pod_metric_selector__+}"}[5m]))'
        aliasTemplate: "HTTP - 5xx error ratio"
        unit: percent
      threshold: 0
      titleTemplate: "HTTP - 5xx error ratio"
    identifier: "urn:stackpack:community-kubernetes:shared:monitor:http-error-ratio-for-service"
    description: "{{ include "./monitors/http-error-ratio-for-service/description" }}"
    status: "ENABLED"
    intervalSeconds: 10
    remediationHint: ""
    dummy: true